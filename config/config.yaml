# Enhanced Configuration for RL Portfolio Optimization
# Includes transaction cost analysis, market constraints, regime analysis, etc.

# Data Configuration
data:
  start_date: "2015-01-01"
  end_date: "2024-12-31"
  train_start: "2015-01-01"
  train_end: "2022-12-31"
  test_start: "2023-01-01"
  test_end: "2024-12-31"

  # Asset Universe (25 assets across 4 asset classes)
  assets:
    equities:
      - AAPL # Apple
      - MSFT # Microsoft
      - GOOGL # Alphabet
      - AMZN # Amazon
      - TSLA # Tesla
      - JPM # JP Morgan
      - V # Visa
      - JNJ # Johnson & Johnson
      - WMT # Walmart
      - PG # Procter & Gamble

    cryptocurrencies:
      - BTC-USD # Bitcoin
      - ETH-USD # Ethereum
      - BNB-USD # Binance Coin
      - ADA-USD # Cardano
      - XRP-USD # Ripple

    commodities:
      - GC=F # Gold Futures
      - SI=F # Silver Futures
      - CL=F # Crude Oil Futures
      - NG=F # Natural Gas Futures
      - HG=F # Copper Futures

    fixed_income:
      - TLT # 20+ Year Treasury Bond ETF
      - IEF # 7-10 Year Treasury Bond ETF
      - SHY # 1-3 Year Treasury Bond ETF
      - LQD # Investment Grade Corporate Bond ETF
      - HYG # High Yield Corporate Bond ETF

  # Technical Indicators
  technical_indicators:
    - macd
    - rsi
    - cci
    - dx
    - boll_ub
    - boll_lb

  # Macroeconomic Factors
  macro_factors:
    - ^VIX # VIX Volatility Index

# Environment Configuration
environment:
  initial_amount: 1000000
  transaction_cost_pct: 0.001 # 0.1% - baseline
  slippage_coefficient: 0.05
  reward_scaling: 1.0
  hmax: 100
  print_verbosity: 5

# Transaction Cost Analysis Configuration
transaction_costs:
  enabled: true
  cost_structures:
    retail: 0.005 # 0.5% - retail investor
    standard: 0.001 # 0.1% - standard
    institutional: 0.0005 # 0.05% - institutional
    zero: 0.0 # 0% - for comparison
  rebalance_frequencies:
    daily: 1
    weekly: 5
    biweekly: 10
    monthly: 20
    quarterly: 60
  analysis_output: "./results/transaction_cost_analysis"

# Market Constraints Configuration
constraints:
  enabled: true
  short_selling: false # Allow short selling
  max_leverage: 1.0 # 1.0 = no leverage, 2.0 = 2x leverage
  max_position_size: 0.3 # Maximum 30% per asset
  min_position_size: 0.0 # Minimum 0% per asset
  sector_exposure_limits:
    equities: 0.6 # Max 60% in equities
    cryptocurrencies: 0.3 # Max 30% in crypto
    commodities: 0.3 # Max 30% in commodities
    fixed_income: 0.5 # Max 50% in bonds

# Reward Function Ablation Study Configuration
reward_ablation:
  enabled: true
  lambda_values: [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
  n_seeds: 5
  output_dir: "./results/reward_ablation"

# Market Regime Analysis Configuration
regime_analysis:
  enabled: true
  methods:
    - "volatility" # VIX-based
    - "trend" # Moving average crossover
    - "returns" # Return-based clustering
  regime_definitions:
    bull:
      vix_threshold: 20
      return_threshold: 0.15
    bear:
      vix_threshold: 30
      return_threshold: -0.10
    sideways:
      vix_range: [15, 25]
      return_range: [-0.05, 0.10]
  output_dir: "./results/regime_analysis"

# Risk Management
risk:
  max_drawdown_penalty: 0.5 # Lambda coefficient
  risk_free_rate: 0.045 # 4.5% annual
  cvar_alpha: 0.05 # 5% for CVaR calculation
  var_alpha: 0.05 # 5% for VaR calculation

# Model Hyperparameters
models:
  ppo:
    n_steps: 2048
    batch_size: 256
    learning_rate: 0.0003
    ent_coef: 0.01
    clip_range: 0.2
    n_epochs: 10
    gae_lambda: 0.95
    max_grad_norm: 0.5
    vf_coef: 0.5
    policy_kwargs:
      net_arch: [128, 64]
      activation_fn: "relu"

  qr_ddpg:
    learning_rate_actor: 0.0001
    learning_rate_critic: 0.0003
    batch_size: 128
    buffer_size: 1000000
    tau: 0.005
    gamma: 0.99
    n_quantiles: 50
    policy_kwargs:
      net_arch: [128, 64]

  ddpg:
    learning_rate_actor: 0.0001
    learning_rate_critic: 0.0003
    batch_size: 128
    buffer_size: 1000000
    tau: 0.005
    gamma: 0.99
    policy_kwargs:
      net_arch: [128, 64]

  sac:
    learning_rate: 0.0003
    batch_size: 256
    buffer_size: 1000000
    tau: 0.005
    gamma: 0.99
    ent_coef: 0.2
    policy_kwargs:
      net_arch: [128, 64]

# Training Configuration
training:
  total_timesteps: 100000
  n_eval_episodes: 10
  eval_freq: 5000
  n_seeds: 10
  log_interval: 100
  save_freq: 10000

# Extended Benchmark Strategies
benchmarks:
  - equal_weight
  - mvo
  - risk_parity
  - minimum_volatility
  - momentum
  - sixty_forty # 60/40 stocks/bonds
  - all_weather # Ray Dalio's All Weather
  - minimum_correlation # Minimum correlation portfolio

# Production Deployment Configuration
production:
  api:
    host: "0.0.0.0"
    port: 8000
    workers: 4
    reload: false
    log_level: "info"

  database:
    host: "localhost"
    port: 5432
    name: "portfolio_db"
    user: "portfolio_user"

  redis:
    host: "localhost"
    port: 6379
    db: 0

  monitoring:
    enabled: true
    prometheus_port: 9090
    grafana_port: 3000

  rebalancing:
    frequency: "weekly" # daily, weekly, monthly
    time: "09:30" # Market open time
    timezone: "US/Eastern"

  risk_monitoring:
    max_drawdown_alert: 0.15 # Alert if drawdown > 15%
    var_limit: 0.05 # VaR limit
    position_limit_alert: 0.35 # Alert if position > 35%

  reporting:
    daily_report: true
    weekly_report: true
    monthly_report: true
    client_reports_enabled: true
    report_recipients:
      - "portfolio@example.com"

# Output Configuration
output:
  results_dir: "./results"
  models_dir: "./models"
  figures_dir: "./results/figures"
  logs_dir: "./results/logs"
  reports_dir: "./results/reports"
